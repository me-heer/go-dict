{{if .Error}}
<div class="error-card">
	{{.Error}}
</div>
{{else if .Results}}
<div class="results-container">
	{{$entry := index .Results 0}}
	<div class="word-card">
		<div class="word-header">
			<h2 class="word-title">{{$entry.Word}}</h2>
			{{if $entry.Phonetic}}
			<span class="phonetic">{{$entry.Phonetic}}</span>
			{{end}}
		</div>

		{{$hasAudio := false}}
		{{range $entry.Phonetics}}
		{{if .Audio}}
		{{$hasAudio = true}}
		<div class="audio-container">
			<audio id="pronunciation-audio" src="{{.Audio}}" preload="auto">
				Your browser does not support the audio element.
			</audio>
			<button id="replay-pronunciation" class="replay-button"
				onclick="document.getElementById('pronunciation-audio').play()">
				<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
					stroke-width="2">
					<polygon points="5 3 19 12 5 21 5 3"></polygon>
				</svg>
				Play pronunciation
			</button>
		</div>
		{{break}}
		{{end}}
		{{end}}

		{{range $entry.Meanings}}
		<div class="meaning-section">
			<h3 class="part-of-speech">{{.PartOfSpeech}}</h3>
			<ol class="definitions-list">
				{{range .Definitions}}
				<li class="definition-item">
					<p class="definition">{{.Definition}}</p>
					{{if .Example}}
					<p class="example">"{{.Example}}"</p>
					{{end}}
					{{if .Synonyms}}
					<div class="synonyms">
						<span class="label">Synonyms: </span>
						<span>{{range $i, $syn := .Synonyms}}{{if $i}},
							{{end}}{{$syn}}{{end}}</span>
					</div>
					{{end}}
				</li>
				{{end}}
			</ol>
		</div>
		{{end}}
	</div>
</div>

<script>
	// Auto-play pronunciation as soon as the results are loaded
	(function () {
		const audio = document.getElementById('pronunciation-audio');
		if (audio) {
			// Try to play the audio immediately
			audio.play().catch(error => {
				console.log('Autoplay prevented by browser policy. User interaction required.');
				// Make the replay button more visible if autoplay fails
				const replayButton = document.getElementById('replay-pronunciation');
				if (replayButton) {
					replayButton.classList.add('highlight');
				}
			});
		}
	})();
</script>
{{end}}
